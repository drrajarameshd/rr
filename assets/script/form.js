!function(){let e=document.getElementById("appointmentForm"),t=document.getElementById("formSubmit");function r(e,t){let r=document.getElementById(e);r&&(r.textContent=t||"",t?(r.classList.add("active"),r.style.display="block",r.setAttribute("aria-hidden","false")):(r.classList.remove("active"),r.style.display="none",r.setAttribute("aria-hidden","true")))}function n(e,t){let r=document.createElement("div");r.className="form-toast",r.setAttribute("role","status"),r.style.position="fixed",r.style.left="50%",r.style.transform="translateX(-50%)",r.style.bottom="24px",r.style.zIndex=9999,r.style.padding="10px 14px",r.style.borderRadius="8px",r.style.color="#fff",r.style.background=t?"#dc2626":"var(--primary-dark, #16a34a)",r.textContent=e,document.body.appendChild(r),setTimeout(()=>{r.style.transition="opacity .35s",r.style.opacity="0"},3e3),setTimeout(()=>r.remove(),3600)}function a(){r("err-name",""),r("err-phone",""),r("err-email",""),r("err-msg","")}if(!e){console.warn("appointmentForm not found on page.");return}["p_name","p_phone","p_email","p_msg"].forEach(e=>{let t=document.getElementById(e);t&&t.addEventListener("input",()=>{r({p_name:"err-name",p_phone:"err-phone",p_email:"err-email",p_msg:"err-msg"}[e],"")})}),e.addEventListener("submit",async function(s){if(s.preventDefault(),!function e(){let t=!0;a();let n=document.getElementById("p_name").value.trim(),s=document.getElementById("p_phone").value.trim(),l=document.getElementById("p_email").value.trim(),i=document.getElementById("p_msg").value.trim();return n||(r("err-name","Please enter your name."),t=!1),/^[6-9]\d{9}$/.test(s)||(r("err-phone","Enter a valid 10-digit Indian phone number."),t=!1),l&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)&&(r("err-email","Enter a valid email address."),t=!1),i||(r("err-msg","Please enter a brief message."),t=!1),t}())return;t&&(t.disabled=!0,t.textContent="⏳ Sending...");let l=new URLSearchParams;l.append("name",document.getElementById("p_name").value.trim()),l.append("phone",document.getElementById("p_phone").value.trim()),l.append("email",document.getElementById("p_email").value.trim()),l.append("message",document.getElementById("p_msg").value.trim());try{let i=await fetch("https://script.google.com/macros/s/AKfycbxTfTr5aJcp6OFO4gjWvw74qMETwAnQ4uYobbDwQYwiwjJ_yZzIZx637wjh-s-IA8PV/exec",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:l.toString()}),o=await i.text().catch(()=>"");console.debug("Server response (text):",o);let m=null;try{m=o?JSON.parse(o):null,console.debug("Server response parsed as JSON:",m)}catch(d){}if(!i.ok){let p=m&&m.message?m.message:o||`Server returned ${i.status}`;throw Error(p)}if(m&&"error"===m.status)throw Error(m.message||"Server returned an error");n("✅ Request sent — we will contact you shortly"),e.reset(),a()}catch(u){console.error("Form submit error:",u),n("❌ Submission failed. Please try again later.",!0)}finally{t&&(t.disabled=!1,t.textContent="Send Request")}})}();
